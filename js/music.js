class ScoMusicPlayer{constructor(){this.init()}init(){document.documentElement.style.setProperty("--vh",`${window.innerHeight}px`),this.getCustomPlayList(),this.addEventListenerToDocument(),this.addButtonListEventListener()}getCustomPlayList(){this.changeMusicBg(!1)}addEventListenerToDocument(){document.addEventListener("keydown",this.handleKeydown.bind(this))}addButtonListEventListener(){const e=document.querySelector(".aplayer-list");document.querySelector(".aplayer-lrc")?.addEventListener("click",(()=>{e.classList.toggle("aplayer-list-hide")}))}changeMusicBg(e=!0){const t=document.getElementById("Music-bg"),n=document.getElementsByClassName("Music-loading")[0];e?this.updateBackgroundImage(t):this.setLoadingScreen(n,t)}updateBackgroundImage(e){const t=document.querySelector("#Music-page .aplayer-pic"),n=new Image;n.src=this.extractValue(t.style.backgroundImage),n.onload=()=>{e.style.backgroundImage=t.style.backgroundImage}}setLoadingScreen(e,t){const n=setInterval((()=>{document.querySelector("#Music-page .aplayer-pic")&&(e.style.display="none",clearInterval(n),document.querySelector("meting-js").aplayer.volume(.8,!0),this.addEventListenerChangeMusicBg(),t.style.display="block"),this.addButtonListEventListener()}),100)}extractValue(e){const t=/url\("([^"]+)"\)/.exec(e);return t?t[1]:""}addEventListenerChangeMusicBg(){const e=document.querySelector("#Music-page meting-js").aplayer;e.on("loadeddata",this.changeMusicBg.bind(this,!0)),e.on("timeupdate",this.lrcUpdate.bind(this))}lrcUpdate(){const e=document.querySelector(".aplayer-lrc-contents"),t=e.querySelector("p.aplayer-lrc-current");if(t){const n=Array.from(e.children).indexOf(t);e.style.transform=`translateY(${80*-n}px)`}}handleKeydown(e){const t=document.querySelector("meting-js").aplayer;switch(e.code){case"Space":e.preventDefault(),t.toggle();break;case"ArrowRight":e.preventDefault(),t.skipForward();break;case"ArrowLeft":e.preventDefault(),t.skipBack();break;case"ArrowUp":e.preventDefault(),t.volume<1&&t.volume(t.volume+.1);break;case"ArrowDown":e.preventDefault(),t.volume>0&&t.volume(t.volume-.1)}}destroy(){document.removeEventListener("keydown",this.handleKeydown)}}function initializeMusicPlayer(){let e=window.scoMusic;e&&e.destroy(),window.scoMusic=new ScoMusicPlayer}